<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace ModStart\Widget\Chart; use ModStart\Core\Util\ColorUtil; use ModStart\Core\Util\TimeUtil; class Bar extends Chart { protected $option = array('grid' => array('right' => '1%', 'left' => '1%', 'bottom' => '10%', 'containLabel' => true), 'toolbox' => array('feature' => array('dataView' => array('show' => true, 'readOnly' => false), 'restore' => array('show' => true), 'saveAsImage' => array('show' => true))), 'tooltip' => array('trigger' => 'axis', 'axisPointer' => array('type' => 'shadow', 'snap' => true, 'crossStyle' => array('color' => '#999'))), 'legend' => array('data' => array()), 'xAxis' => array('type' => 'category', 'data' => array()), 'yAxis' => array('type' => 'value', 'minInterval' => 1), 'series' => array()); public function ySeries($qsK6T, $VuXfH, $HQ4FM = '数量', $kKcR8 = array()) { goto w6rE1; gIw0P: return $this; goto hnyf3; tOnc9: $this->option['legend']['data'][$qsK6T] = $HQ4FM; goto EKIiq; EKIiq: $this->option['series'][$qsK6T] = array('name' => $HQ4FM, 'data' => $VuXfH, 'type' => 'bar', 'smooth' => true, 'itemStyle' => array('normal' => array('color' => $kKcR8['barColor'], 'barStyle' => array('color' => $kKcR8['barColor'])))); goto gIw0P; w6rE1: if (!isset($kKcR8['barColor'])) { $kKcR8['barColor'] = ColorUtil::pick('L-' . $qsK6T); } goto tOnc9; hnyf3: } public function tableDailyCountLatest($xTHe7 = array(), $d5BqU = 15) { goto jir2b; CvSm4: $ts5Yu = strtotime($pzyNL); goto xU0P1; Yztmy: $aibkj = date('Y-m-d', $Wzqzm); goto UJsLt; UJsLt: return $this->tableDailyCount($aibkj, $pzyNL, $xTHe7); goto em9zz; jir2b: $pzyNL = date('Y-m-d'); goto CvSm4; xU0P1: $Wzqzm = $ts5Yu - ($d5BqU - 1) * TimeUtil::PERIOD_DAY; goto Yztmy; em9zz: } public function tableDailyCount($aibkj, $pzyNL, $xTHe7 = array()) { goto stORr; Uob6R: $this->xData($nx179['time']); goto YeGHP; YeGHP: $this->option['series'] = array(); goto pL9hu; stORr: $nx179 = $this->dsTableCountSeriesDaily($aibkj, $pzyNL, $xTHe7); goto Uob6R; pL9hu: foreach ($nx179['values'] as $kOFY1 => $VuXfH) { $u9AuJ = isset($xTHe7[$kOFY1]['color']) ? $xTHe7[$kOFY1]['color'] : ColorUtil::randomColor(); $this->option['series'][] = array('name' => $xTHe7[$kOFY1]['title'], 'data' => $VuXfH, 'type' => 'bar', 'smooth' => true, 'itemStyle' => array('normal' => array('color' => $u9AuJ, 'barStyle' => array('color' => $u9AuJ)))); } goto tc61k; tc61k: return $this; goto Y2gdO; Y2gdO: } public function tableDailySumLatest($xTHe7 = array(), $d5BqU = 15) { goto C_til; C_til: $pzyNL = date('Y-m-d'); goto eWgGa; EYPLA: $Wzqzm = $ts5Yu - ($d5BqU - 1) * TimeUtil::PERIOD_DAY; goto Gym9H; Gym9H: $aibkj = date('Y-m-d', $Wzqzm); goto U3jQp; U3jQp: return $this->tableDailySum($aibkj, $pzyNL, $xTHe7); goto v9rHh; eWgGa: $ts5Yu = strtotime($pzyNL); goto EYPLA; v9rHh: } public function tableDailySum($aibkj, $pzyNL, $xTHe7 = array()) { goto V82Rb; RUa8Q: foreach ($nx179['values'] as $kOFY1 => $VuXfH) { $u9AuJ = isset($xTHe7[$kOFY1]['color']) ? $xTHe7[$kOFY1]['color'] : ColorUtil::randomColor(); $this->option['series'][] = array('name' => $xTHe7[$kOFY1]['title'], 'data' => $VuXfH, 'type' => 'bar', 'smooth' => true, 'itemStyle' => array('normal' => array('color' => $u9AuJ, 'barStyle' => array('color' => $u9AuJ)))); } goto gmTKq; gmTKq: return $this; goto ViEZR; I_IcD: $this->option['series'] = array(); goto RUa8Q; V82Rb: $nx179 = $this->dsTableSumSeriesDaily($aibkj, $pzyNL, $xTHe7); goto Ra0c7; Ra0c7: $this->xData($nx179['time']); goto I_IcD; ViEZR: } }