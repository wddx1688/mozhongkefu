<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace ModStart\Admin\Layout; use ModStart\Detail\Detail; use ModStart\Form\Form; use ModStart\Grid\Grid; use ModStart\Support\Concern\HasFluentAttribute; class AdminCRUDBuilder { const MODE_GRID = 'grid'; const MODE_DETAIL = 'detail'; const MODE_FORM = 'form'; use HasFluentAttribute; private $mode; protected $fluentAttributes = array('model', 'field'); private $model; private $field; private $grid; private $form; private $detail; public function useModeGrid() { $this->mode = 'grid'; } public function useModeForm() { $this->mode = 'form'; } public function useModeDetail() { $this->mode = 'detail'; } public function init($Qelul) { goto VGKkf; VGKkf: $this->model = $Qelul; goto JLkGG; wEPnS: return $this; goto nx4mo; JLkGG: switch ($this->mode) { case 'grid': $this->grid = Grid::make($this->model); break; case 'form': $this->form = Form::make($this->model); break; case 'detail': $this->detail = Detail::make($this->model); break; } goto wEPnS; nx4mo: } public function grid() { $this->grid->builder(function (Grid $h7Rk_) { if ($this->field) { call_user_func($this->field, $h7Rk_); } }); return $this->grid; } public function form() { $this->form->builder(function (Form $c9K5c) { if ($this->field) { call_user_func($this->field, $c9K5c); } }); return $this->form; } public function detail() { $this->detail->builder(function (Detail $LT01t) { if ($this->field) { call_user_func($this->field, $LT01t); } }); return $this->detail; } public function mode() { return $this->mode; } public function __call($HQ4FM, $wnXyT) { goto ieNL0; Np3gL: switch ($this->mode) { case 'grid': return call_user_func_array(array($this->grid, $HQ4FM), $wnXyT); case 'form': return call_user_func_array(array($this->form, $HQ4FM), $wnXyT); case 'detail': return call_user_func_array(array($this->detail, $HQ4FM), $wnXyT); } goto ZnvQp; ieNL0: if ($this->isFluentAttribute($HQ4FM)) { return $this->fluentAttribute($HQ4FM, $wnXyT); } goto Np3gL; ZnvQp: throw new \Exception('AdminCRUDBuilder call error : ' . $HQ4FM); goto FdNQf; FdNQf: } }