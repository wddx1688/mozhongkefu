<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace ModStart\Admin; use Illuminate\Support\Facades\Cache; use Illuminate\Support\Facades\Route; use ModStart\ModStart; use ModStart\Module\ModuleManager; class ModStartAdmin { public static function registerAuthRoutes() { Route::group(array('prefix' => config('modstart.admin.prefix'), 'namespace' => '\\ModStart\\Admin\\Controller', 'middleware' => array('admin.bootstrap', 'admin.auth')), function ($router) { $router->match(array('get', 'post'), 'login', 'AuthController@login'); $router->match(array('get', 'post'), 'login_quick', 'AuthController@loginQuick'); $router->match(array('get'), 'logout', 'AuthController@logout'); $router->match(array('get'), 'login/captcha', 'AuthController@loginCaptcha'); $router->match(array('get'), 'sso/client', 'AuthController@ssoClient'); $router->match(array('get'), 'sso/server', 'AuthController@ssoServer'); $router->match(array('get'), 'sso/server_success', 'AuthController@ssoServerSuccess'); $router->match(array('get'), 'sso/server_logout', 'AuthController@ssoServerLogout'); $router->match(array('post'), 'util/frame', 'UtilController@frame'); $router->match(array('get'), 'util/switch_lang', 'UtilController@switchLang'); $router->match(array('post'), 'system/clear_cache', 'SystemController@clearCache'); $router->match(array('get', 'post'), 'system/security_fix', 'SystemController@securityFix'); $router->match(array('get', 'post'), 'admin_role', 'AdminRoleController@index'); $router->match(array('get', 'post'), 'admin_role/add', 'AdminRoleController@add'); $router->match(array('get', 'post'), 'admin_role/edit', 'AdminRoleController@edit'); $router->match(array('post'), 'admin_role/delete', 'AdminRoleController@delete'); $router->match(array('get'), 'admin_role/show', 'AdminRoleController@show'); $router->match(array('get', 'post'), 'admin_user', 'AdminUserController@index'); $router->match(array('get', 'post'), 'admin_user/add', 'AdminUserController@add'); $router->match(array('get', 'post'), 'admin_user/edit', 'AdminUserController@edit'); $router->match(array('post'), 'admin_user/delete', 'AdminUserController@delete'); $router->match(array('get'), 'admin_user/show', 'AdminUserController@show'); $router->match(array('get', 'post'), 'profile/change_password', 'ProfileController@changePassword'); $router->match(array('get', 'post'), 'admin_log', 'AdminLogController@index'); $router->match(array('get'), 'admin_log/show', 'AdminLogController@show'); $router->match(array('post'), 'admin_log/delete', 'AdminLogController@delete'); $router->match(array('get', 'post'), 'data/file_manager/{category}', 'DataController@fileManager'); $router->match(array('get', 'post'), 'data/ueditor', 'DataController@ueditor'); }); } private static function listModuleRoutes() { goto CmN17; bFXQ8: return $a3n3M; goto SWnVe; cRTYV: foreach ($RwIYu as $C1S_N) { if (file_exists($Z3orD = ModuleManager::path($C1S_N, 'Admin/routes.php'))) { $a3n3M[$C1S_N] = $Z3orD; } } goto bFXQ8; CmN17: $RwIYu = ModuleManager::listAllInstalledModulesInRequiredOrder(); goto e9lft; e9lft: $a3n3M = array(); goto cRTYV; SWnVe: } public static function registerModuleRoutes() { goto SBf5m; ZeQn7: if (file_exists($m7P8u = modstart_admin_path('routes.php'))) { require $m7P8u; } goto hMHGf; zQl1D: foreach ($Q9kQu as $C1S_N => $Z3orD) { Route::group(array('prefix' => config('modstart.admin.prefix'), 'middleware' => array('admin.bootstrap', 'admin.auth'), 'namespace' => "\\Module\\{$C1S_N}\\Admin\\Controller"), function ($router) use($Z3orD) { if (file_exists($Z3orD)) { require $Z3orD; } }); } goto ZeQn7; SBf5m: if (config('env.APP_DEBUG')) { $Q9kQu = self::listModuleRoutes(); } else { if (method_exists(ModStart::class, 'cacheKey')) { $Q9kQu = Cache::rememberForever(ModStart::cacheKey('ModStartAdminRoutes'), function () { return self::listModuleRoutes(); }); } else { $Q9kQu = self::listModuleRoutes(); } } goto zQl1D; hMHGf: } }