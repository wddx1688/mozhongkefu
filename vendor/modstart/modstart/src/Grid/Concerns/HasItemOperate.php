<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace ModStart\Grid\Concerns; use ModStart\Field\AbstractField; use ModStart\Field\Display; use ModStart\Grid\Displayer\ItemOperate; use ModStart\Support\Concern\HasSetting; trait HasItemOperate { private $itemOperate; private $hookItemOperateRendering; private $hookItemOperateFieldBuild; private function setupItemOperate() { $this->itemOperate = new ItemOperate($this); } private function prepareItemOperateField() { if ($this->canEdit || $this->canShow || $this->canDelete || $this->hookItemOperateRendering) { goto M4V6B; M4V6B: $dBa7F = new Display('_operate', array(L('Operate'))); goto zot4V; zdfTF: if ($this->hookItemOperateFieldBuild) { call_user_func($this->hookItemOperateFieldBuild, $dBa7F); } goto itSit; zot4V: $dBa7F->hookRendering(function (AbstractField $dBa7F, $DUr2V, $kOFY1) { $this->itemOperate->reset()->item($DUr2V)->index($kOFY1); $this->itemOperate->setField($dBa7F); if ($this->hookItemOperateRendering) { call_user_func($this->hookItemOperateRendering, $this->itemOperate); } return $this->itemOperate->render(); }); goto zdfTF; itSit: $this->pushField($dBa7F); goto OC8g9; OC8g9: } } public function disableItemOperate() { goto IuPZ_; z3BG9: return $this; goto g46Cy; E_6yj: $this->canShow = false; goto YVMQe; YVMQe: $this->canDelete = false; goto NWPVX; NWPVX: $this->hookItemOperateRendering = false; goto z3BG9; IuPZ_: $this->canEdit = false; goto E_6yj; g46Cy: } public function hookItemOperateRendering($k_TMY = null) { goto MoAed; UfWps: $this->hookItemOperateRendering = $k_TMY; goto ZAUcz; ZAUcz: return $this; goto vL39z; MoAed: if (null === $k_TMY) { return $this->hookItemOperateRendering; } goto UfWps; vL39z: } public function hookItemOperateFieldBuild($k_TMY = null) { goto wFozr; PQCgC: return $this; goto rscTL; uBi1Q: $this->hookItemOperateFieldBuild = $k_TMY; goto PQCgC; wFozr: if (null === $k_TMY) { return $this->hookItemOperateFieldBuild; } goto uBi1Q; rscTL: } public function operateFixed($tt6pz) { $this->hookItemOperateFieldBuild(function (AbstractField $dBa7F) use($tt6pz) { $dBa7F->gridFixed($tt6pz); }); return $this; } }