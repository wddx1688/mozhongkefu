<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace ModStart\Core\Util; use Illuminate\Support\Facades\Request; use Jenssegers\Agent\Facades\Agent; class AgentUtil { public static function getUserAgent() { goto ngd2o; QF_HD: if (null === $zm1Wf) { $zm1Wf = Request::header('User-Agent'); } goto iE3Ir; iE3Ir: return $zm1Wf; goto Jdhgu; ngd2o: static $zm1Wf = null; goto QF_HD; Jdhgu: } public static function device() { if (self::isMobile()) { return 'mobile'; } return 'pc'; } public static function isWechat() { goto lPK1Y; lPK1Y: static $s6sfY = null; goto i2c2y; AfOHY: return $s6sfY; goto seaLd; i2c2y: if (null === $s6sfY) { $s6sfY = false; if (strpos(self::getUserAgent(), 'MicroMessenger') !== false) { $s6sfY = true; } } goto AfOHY; seaLd: } public static function isWechatMobile() { return self::isWechat() && !self::isWechatPC(); } public static function isWechatPC() { goto qqM4T; qqM4T: static $npWZw = null; goto bOENK; iR_di: return $npWZw; goto X5i9x; bOENK: if (null === $npWZw) { $npWZw = false; if (self::isWechat()) { $XMIzi = self::getUserAgent(); if (strpos($XMIzi, 'WindowsWechat') !== false || strpos($XMIzi, 'MacWechat') !== false) { $npWZw = true; } } } goto iR_di; X5i9x: } public static function isMobile() { return Agent::isPhone() && !self::isWechatPC(); } public static function isPC() { return !self::isMobile(); } private static $robots = array('/googlebot/i' => 'Google', '/baiduspider/i' => 'Baidu', '/360spider/i' => '360', '/sogou/i' => 'Sogou', '/bingbot/i' => 'Bing', '/bytespider/i' => 'TouTiao', '/crawler/i' => 'Other', '/spider/i' => 'Other', '/(?:^|[\\W])\\w*bot([\\W\\s]|$)/i' => 'Other', '/detector/i' => 'Other', '/(curl|python|java|node-fetch|http-client|msray-plus|guzzlehttp|wget|okhttp)/i' => 'Other', '/(ows.eu|researchscan|github|LogStatistic|Dataprovider|facebook)/i' => 'Other'); public static function detectRobot($zm1Wf = null) { goto cxM6m; kULvF: foreach (self::$robots as $PjL1d => $rQNi0) { if (preg_match($PjL1d, $zm1Wf)) { return $rQNi0; } } goto EhKEx; EhKEx: return null; goto Tzocr; cxM6m: if (null === $zm1Wf) { $zm1Wf = AgentUtil::getUserAgent(); } goto kULvF; Tzocr: } }