<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace ModStart\Core\Util; use Illuminate\Support\Facades\Route; use Illuminate\Support\Facades\View; use ModStart\Core\Input\InputPackage; use ModStart\Grid\Grid; use ModStart\Grid\Type\GridEngine; class CRUDUtil { public static function copyId($bX2xJ = null) { $gY_Ck = InputPackage::buildFromInput(); return $gY_Ck->getInteger('_copyId', $bX2xJ); } public static function scope($bX2xJ = null) { $gY_Ck = InputPackage::buildFromInput(); return $gY_Ck->getTrimString('_scope', $bX2xJ); } public static function id() { goto WLB9u; WLB9u: $gY_Ck = InputPackage::buildFromInput(); goto G02aZ; jwx7y: return $CeOJi; goto B84e1; G02aZ: $CeOJi = $gY_Ck->getInteger('_id'); goto HggR1; HggR1: if (!$CeOJi) { $CeOJi = $gY_Ck->getInteger('id'); } goto jwx7y; B84e1: } public static function ids() { goto EMRgY; hvQmu: foreach (explode(',', $CeOJi) as $qsK6T) { $iUHLt[] = intval($qsK6T); } goto U27VQ; uOmPH: if (!$CeOJi) { $CeOJi = $gY_Ck->getTrimString('id'); if (empty($CeOJi)) { $CeOJi = $gY_Ck->getTrimString('ids'); } } goto wCXP7; wCXP7: $iUHLt = array(); goto hvQmu; U27VQ: return $iUHLt; goto BSKDh; Em17T: $CeOJi = $gY_Ck->getTrimString('_id'); goto uOmPH; EMRgY: $gY_Ck = InputPackage::buildFromInput(); goto Em17T; BSKDh: } public static function registerRouteResource($OFAbu, $cVwn0) { goto GOpV_; Pqx30: Route::match(array('post'), "{$OFAbu}/sort", "{$cVwn0}@sort"); goto tZUbR; Acrdl: Route::match(array('get'), "{$OFAbu}/show", "{$cVwn0}@show"); goto Pqx30; kG3SN: Route::match(array('post'), "{$OFAbu}/delete", "{$cVwn0}@delete"); goto Acrdl; BjVjc: Route::match(array('get', 'post'), "{$OFAbu}/add", "{$cVwn0}@add"); goto aFimh; aFimh: Route::match(array('get', 'post'), "{$OFAbu}/edit", "{$cVwn0}@edit"); goto kG3SN; GOpV_: Route::match(array('get', 'post'), "{$OFAbu}", "{$cVwn0}@index"); goto BjVjc; tZUbR: } public static function registerGridResource(Grid $h7Rk_, $cVwn0, $kKcR8 = array()) { goto noEmH; h1oMG: if ($h7Rk_->canSort() && ($ikc2A = action($cVwn0 . '@sort', $kKcR8))) { $h7Rk_->urlSort($ikc2A); } goto QQUqv; QQUqv: if ($h7Rk_->canExport() && ($ikc2A = action($cVwn0 . '@export', $kKcR8))) { $h7Rk_->urlExport($ikc2A); } goto J7v1R; J7v1R: if ($h7Rk_->canImport() && ($ikc2A = action($cVwn0 . '@import', $kKcR8))) { $h7Rk_->urlImport($ikc2A); } goto soiiR; vxgqo: if ($h7Rk_->canEdit() && ($ikc2A = action($cVwn0 . '@edit', $kKcR8))) { $h7Rk_->urlEdit($ikc2A); } goto moi3C; noEmH: if ($h7Rk_->canAdd() && ($ikc2A = action($cVwn0 . '@add', $kKcR8))) { switch ($h7Rk_->engine()) { case GridEngine::TREE_MASS: goto e676K; P1ScE: $IpOIw['_pid'] = $gY_Ck->get('_pid', $h7Rk_->treeRootPid()); goto PqwoM; ir_Iw: $IpOIw = array(); goto P1ScE; CCFAI: break; goto BTKfS; PqwoM: $h7Rk_->urlAdd($ikc2A . (strpos($ikc2A, '?') > 0 ? '&' : '?') . http_build_query($IpOIw)); goto CCFAI; e676K: $gY_Ck = InputPackage::buildFromInput(); goto ir_Iw; BTKfS: default: $h7Rk_->urlAdd($ikc2A); break; } } goto vxgqo; lWrh9: if ($h7Rk_->canShow() && ($ikc2A = action($cVwn0 . '@show', $kKcR8))) { $h7Rk_->urlShow($ikc2A); } goto h1oMG; moi3C: if ($h7Rk_->canDelete() && ($ikc2A = action($cVwn0 . '@delete', $kKcR8))) { $h7Rk_->urlDelete($ikc2A); } goto lWrh9; soiiR: } public static function jsGridRefresh($kOFY1 = 0) { return "[js]window.__grids.get({$kOFY1}).lister.refresh();"; } public static function jsDialogCloseAndParentGridRefresh($kOFY1 = 0) { return "[js]parent.__grids.get({$kOFY1}).lister.refresh();__dialogClose();"; } public static function jsDialogClose() { return '[js]__dialogClose();'; } public static function jsDialogCloseAndParentRefresh() { return '[js]parent.location.reload();'; } public static function adminRedirectOrTabClose($ikc2A) { goto RyIAS; ln3xG: if (View::shared('_isTab')) { $vqlrZ = '[tab-close]'; } goto qMeiv; qMeiv: return $vqlrZ; goto BooHM; RyIAS: $vqlrZ = modstart_admin_url($ikc2A); goto ln3xG; BooHM: } public static function adminUrlWithTab($ikc2A, $IpOIw = array()) { if (View::shared('_isTab')) { $IpOIw['_is_tab'] = 1; } return modstart_admin_url($ikc2A, $IpOIw); } }