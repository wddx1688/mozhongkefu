<?php
/**
 * ------------------------ 
 *  ç‰ˆæƒæ‰€æœ‰  www.tecmz.com
 *  å•†ä¸šç‰ˆæœ¬è¯·è´­ä¹°æ­£ç‰ˆæŽˆæƒä½¿ç”¨
 * ------------------------
*/ namespace ModStart\Core\Util\Support; class MP3File { protected $filename; public function __construct($owyBa) { $this->filename = $owyBa; } public static function formatTime($yV7sQ) { goto Q30Or; gftNJ: return sprintf('%02d:%02d:%02d', $jg1iM, $c1QSu, $DHk5j); goto aU7eO; Q30Or: $jg1iM = floor($yV7sQ / 3600); goto bUDjE; bUDjE: $c1QSu = floor(($yV7sQ - $jg1iM * 3600) / 60); goto XYcmx; XYcmx: $DHk5j = $yV7sQ - $jg1iM * 3600 - $c1QSu * 60; goto gftNJ; aU7eO: } public function getDurationEstimate() { return $this->getDuration($WDAQS = true); } public function getDuration($WDAQS = false) { goto UVybW; btB1M: return round($yV7sQ); goto YdU5K; xmW8I: $YAhv3 = fread($zEt3z, 100); goto PcS2o; W7jBf: $yV7sQ = 0; goto xmW8I; OeMNB: while (!feof($zEt3z)) { $YAhv3 = fread($zEt3z, 10); if (strlen($YAhv3) < 10) { break; } else { if ($YAhv3[0] == 'ÿ' && ord($YAhv3[1]) & 224) { goto npkJb; RVOO5: fseek($zEt3z, $nyHgK['Framesize'] - 10, SEEK_CUR); goto J5Q_y; Ck6kL: if (empty($nyHgK['Framesize'])) { return $yV7sQ; } goto RVOO5; J5Q_y: $yV7sQ += $nyHgK['Samples'] / $nyHgK['Sampling Rate']; goto tE2rh; npkJb: $nyHgK = self::parseFrameHeader(substr($YAhv3, 0, 4)); goto Ck6kL; tE2rh: } else { if (substr($YAhv3, 0, 3) == 'TAG') { fseek($zEt3z, 128 - 10, SEEK_CUR); } else { fseek($zEt3z, -9, SEEK_CUR); } } } if ($WDAQS && !empty($nyHgK)) { return $this->estimateDuration($nyHgK['Bitrate'], $Esp4L); } } goto btB1M; XEaq0: fseek($zEt3z, $Esp4L, SEEK_SET); goto OeMNB; PcS2o: $Esp4L = $this->skipID3v2Tag($YAhv3); goto XEaq0; UVybW: $zEt3z = fopen($this->filename, 'rb'); goto W7jBf; YdU5K: } private function estimateDuration($n4YYl, $Esp4L) { goto hbGfu; QlAcd: $iGaXe = filesize($this->filename) - $Esp4L; goto TmdbR; TmdbR: return round($iGaXe / $J8II_); goto ujTYu; hbGfu: $J8II_ = $n4YYl * 1000 / 8; goto QlAcd; ujTYu: } private function skipID3v2Tag(&$YAhv3) { if (substr($YAhv3, 0, 3) == 'ID3') { goto AGaza; cuM_e: $XozGt = $J6KSN & 32 ? 1 : 0; goto h6VzM; BG1R0: $BqEtO = ord($YAhv3[9]); goto bsYbf; WpPnL: $uFObr = $J6KSN & 64 ? 1 : 0; goto cuM_e; DuzG1: $fBd1v = ord($YAhv3[8]); goto BG1R0; AGaza: $OUGUz = ord($YAhv3[3]); goto tPbsQ; h6VzM: $pAoUR = $J6KSN & 16 ? 1 : 0; goto XWfp7; XWfp7: $GRlCB = ord($YAhv3[6]); goto KExoh; lHEl1: $QN014 = $J6KSN & 128 ? 1 : 0; goto WpPnL; KExoh: $z1mRW = ord($YAhv3[7]); goto DuzG1; gGmUg: $J6KSN = ord($YAhv3[5]); goto lHEl1; bsYbf: if (($GRlCB & 128) == 0 && ($z1mRW & 128) == 0 && ($fBd1v & 128) == 0 && ($BqEtO & 128) == 0) { goto MDv39; mX2Zr: return $Klilg + $CVoZ_ + $Kj_bb; goto tzvLI; MDv39: $Klilg = 10; goto adYDA; adYDA: $CVoZ_ = ($GRlCB & 127) * 2097152 + ($z1mRW & 127) * 16384 + ($fBd1v & 127) * 128 + ($BqEtO & 127); goto gMQfy; gMQfy: $Kj_bb = $pAoUR ? 10 : 0; goto mX2Zr; tzvLI: } goto JQT8A; tPbsQ: $isaNQ = ord($YAhv3[4]); goto gGmUg; JQT8A: } return 0; } public static function parseFrameHeader($ZL5Wc) { goto HPoWf; IhlNG: $nyHgK['Layer'] = $YY1rq; goto NC0AM; PfhLi: $n4YYl = isset($NmPpb[$UO52_][$ibg12]) ? $NmPpb[$UO52_][$ibg12] : 0; goto h_1zr; Yp3cj: static $hijmv = array('1' => array(44100, 48000, 32000), '2' => array(22050, 24000, 16000), '2.5' => array(11025, 12000, 8000)); goto LI0p5; L2hdd: $Ymdr4 = ($Uv62E & 8) >> 3; goto pVf_x; LpUKQ: $nyHgK['Version'] = $vRbzB; goto IhlNG; mgmM4: $sbly4 = ($Uv62E & 48) >> 4; goto L2hdd; GtCK5: $Uv62E = ord($ZL5Wc[3]); goto A4HuI; obVgD: $AwGFV = ($g10CY & 6) >> 1; goto Z7PiX; YBczl: $nyHgK = array(); goto LpUKQ; yF6n4: static $fY9T1 = array(0 => 'x', 1 => '3', 2 => '2', 3 => '1'); goto tSCkK; HPoWf: static $DRYeH = array(0 => '2.5', 1 => 'x', 2 => '2', 3 => '1'); goto yF6n4; tSCkK: static $NmPpb = array('V1L1' => array(0, 32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448), 'V1L2' => array(0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384), 'V1L3' => array(0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320), 'V2L1' => array(0, 32, 48, 56, 64, 80, 96, 112, 128, 144, 160, 176, 192, 224, 256), 'V2L2' => array(0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160), 'V2L3' => array(0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160)); goto Yp3cj; A4HuI: $ZObmv = ($g10CY & 24) >> 3; goto kBMdW; pVf_x: $lA_Ie = ($Uv62E & 4) >> 2; goto WTjZ4; NC0AM: $nyHgK['Bitrate'] = $n4YYl; goto w3Ajz; LI0p5: static $YcBwv = array(1 => array(1 => 384, 2 => 1152, 3 => 1152), 2 => array(1 => 384, 2 => 1152, 3 => 576)); goto AWaHY; WTjZ4: $ahqtG = $Uv62E & 3; goto YBczl; kBMdW: $vRbzB = $DRYeH[$ZObmv]; goto d_xLr; w3Ajz: $nyHgK['Sampling Rate'] = $gnlaC; goto ajxNG; N2K_k: $gnlaC = isset($hijmv[$vRbzB][$uak4n]) ? $hijmv[$vRbzB][$uak4n] : 0; goto F86ax; AWaHY: $g10CY = ord($ZL5Wc[1]); goto w_9sG; od_pZ: $GU2FH = $S949e & 1; goto AzzvD; FKwg9: $UO52_ = sprintf('V%dL%d', $MPJK7, $YY1rq); goto FG8ED; ajxNG: $nyHgK['Framesize'] = self::framesize($YY1rq, $n4YYl, $gnlaC, $pnEdz); goto FypSY; FypSY: $nyHgK['Samples'] = $YcBwv[$MPJK7][$YY1rq]; goto wVk0u; AzzvD: $dX3n5 = ($Uv62E & 192) >> 6; goto mgmM4; FG8ED: $ibg12 = ($S949e & 240) >> 4; goto PfhLi; w_9sG: $S949e = ord($ZL5Wc[2]); goto GtCK5; wVk0u: return $nyHgK; goto lMH50; h_1zr: $uak4n = ($S949e & 12) >> 2; goto N2K_k; d_xLr: $MPJK7 = $vRbzB == '2.5' ? 2 : $vRbzB; goto obVgD; Z7PiX: $YY1rq = $fY9T1[$AwGFV]; goto jod1T; jod1T: $W6sMI = $g10CY & 1; goto FKwg9; F86ax: $pnEdz = ($S949e & 2) >> 1; goto od_pZ; lMH50: } private static function framesize($YY1rq, $n4YYl, $gnlaC, $pnEdz) { if ($YY1rq == 1) { return intval((12 * $n4YYl * 1000 / $gnlaC + $pnEdz) * 4); } else { return intval(144 * $n4YYl * 1000 / $gnlaC + $pnEdz); } } }