<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace ModStart\Core\Assets; use Illuminate\Support\Facades\Request; use Illuminate\Support\Str; use ModStart\Core\Exception\BizException; use ModStart\Core\Util\ShellUtil; class AssetsUtil { public static function cdn() { return app('assetPathDriver')->getCDN(''); } public static function fix($hCl98, $mSCVj = true) { goto XBjcl; CIA5n: if (Str::startsWith($hCl98, 'http://') || Str::startsWith($hCl98, 'https://') || Str::startsWith($hCl98, '//')) { return $hCl98; } goto gXjv1; PvJyX: if ($mSCVj) { $ikc2A .= app('assetPathDriver')->getPathWithHash($hCl98); } else { $ikc2A .= $hCl98; } goto KSYD9; XBjcl: if (empty($hCl98)) { return $hCl98; } goto CIA5n; gXjv1: if (Str::startsWith($hCl98, '/')) { $hCl98 = substr($hCl98, 1); } goto UzgE7; UzgE7: $ikc2A = app('assetPathDriver')->getCDN($hCl98); goto PvJyX; KSYD9: return $ikc2A; goto U64Dw; U64Dw: } public static function fixOrDefault($hCl98, $RsCDD) { if (empty($hCl98)) { return self::fix($RsCDD); } return self::fix($hCl98); } public static function url($Z3orD) { return app('assetPathDriver')->getCDN($Z3orD) . app('assetPathDriver')->getPathWithHash($Z3orD); } public static function fixCurrentDomain($hCl98) { goto fZ6aD; R1oXA: if (!Str::startsWith($hCl98, '/')) { $hCl98 = '/' . $hCl98; } goto bqoSd; bqoSd: if (Request::secure()) { $dYuDi = 'https'; } else { $dYuDi = 'http'; } goto CiPkO; fZ6aD: if (is_array($hCl98)) { return array_values(array_map(function ($RfXiF) { return self::fixCurrentDomain($RfXiF); }, $hCl98)); } goto In3AA; In3AA: if (Str::startsWith($hCl98, 'http://') || Str::startsWith($hCl98, 'https://')) { return $hCl98; } goto R1oXA; CiPkO: if (Str::startsWith($hCl98, '//')) { return $dYuDi . ':' . $hCl98; } goto hKgHV; hKgHV: return $dYuDi . '://' . Request::server('HTTP_HOST') . $hCl98; goto JXYdb; JXYdb: } public static function fixFullFromConfig($K7CjD) { goto TJhgW; TJhgW: $VuXfH = modstart_config($K7CjD); goto l7w10; W6Lpe: return self::fixFull($VuXfH); goto qsRCQ; l7w10: if (empty($VuXfH)) { return null; } goto W6Lpe; qsRCQ: } public static function fixFull($hCl98, $mSCVj = true) { goto PehvR; PehvR: if (is_array($hCl98)) { return array_values(array_map(function ($RfXiF) use($mSCVj) { return self::fixFull($RfXiF, $mSCVj); }, $hCl98)); } goto rARfj; a7t0x: if (Request::secure()) { $dYuDi = 'https'; } else { $dYuDi = 'http'; } goto pFDbm; Wo9s3: $hCl98 = self::fix($hCl98, $mSCVj); goto amy1i; LjRgA: return rtrim($WDsA6, '/') . '/' . ltrim($hCl98, '/'); goto BdTkM; t23eA: $WDsA6 = $dYuDi . '://' . Request::server('HTTP_HOST'); goto d4uji; d4uji: if (ShellUtil::isCli()) { $WDsA6 = config('env.APP_URL'); if (empty($WDsA6)) { $WDsA6 = modstart_config('siteUrl'); } } goto LjRgA; rARfj: if (empty($hCl98)) { return $hCl98; } goto Wo9s3; amy1i: if (Str::startsWith($hCl98, 'http://') || Str::startsWith($hCl98, 'https://')) { return $hCl98; } goto a7t0x; pFDbm: if (Str::startsWith($hCl98, '//')) { return $dYuDi . ':' . $hCl98; } goto t23eA; BdTkM: } public static function fixFullInJob($hCl98, $mSCVj = true) { goto ZxxI5; u16Uh: return rtrim($xT6nh, '/') . '/' . ltrim($hCl98, '/'); goto KItyP; gHIVK: if (Str::startsWith($hCl98, 'http://') || Str::startsWith($hCl98, 'https://')) { return $hCl98; } goto OtFZf; hdUce: $hCl98 = self::fix($hCl98, $mSCVj); goto gHIVK; umN0R: BizException::throwsIfEmpty('APP_URL Required In Job', $xT6nh); goto u16Uh; OtFZf: if (Str::startsWith($hCl98, '//')) { return 'http:' . $hCl98; } goto YAVWz; YAVWz: $xT6nh = config('env.APP_URL'); goto umN0R; ZxxI5: if (empty($hCl98)) { return $hCl98; } goto hdUce; KItyP: } public static function fixFullWithCdn($hCl98, $N1V6D, $mSCVj = true) { goto hl3FJ; rL3iJ: if (Str::startsWith($hCl98, 'http://') || Str::startsWith($hCl98, 'https://')) { return $hCl98; } goto I747k; kWUuG: if (empty($hCl98)) { return $hCl98; } goto rL3iJ; I747k: return $N1V6D . ltrim($hCl98, '/'); goto m2vVW; hl3FJ: if (is_array($hCl98)) { return array_values(array_map(function ($RfXiF) use($N1V6D, $mSCVj) { return self::fixFullWithCdn($RfXiF, $N1V6D, $mSCVj); }, $hCl98)); } goto kWUuG; m2vVW: } public static function fixFullOrDefault($hCl98, $RsCDD = null) { goto bUEL0; bUEL0: if (is_array($hCl98)) { return array_values(array_map(function ($RfXiF) use($RsCDD) { return self::fixFullOrDefault($RfXiF, $RsCDD); }, $hCl98)); } goto cs46Y; RIDfY: return self::fixFull($hCl98); goto SZGt1; cs46Y: if (empty($hCl98)) { return self::fixFull($RsCDD); } goto RIDfY; SZGt1: } public static function recordsFixFullOrDefault(&$nQYo_, $cANPj, $RsCDD = null) { foreach ((array) $cANPj as $lpLIs) { foreach ($nQYo_ as $dKmL2 => $yFWLi) { $nQYo_[$dKmL2][$lpLIs] = self::fixFullOrDefault($yFWLi[$lpLIs], $RsCDD); } } } }