<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace ModStart\Core\Input; use Illuminate\Support\Facades\Input; use ModStart\Core\Util\FormatUtil; use ModStart\Core\Util\HtmlUtil; use ModStart\Core\Util\StrUtil; use ModStart\Core\Util\TagUtil; use ModStart\Core\Util\TimeUtil; use Symfony\Component\HttpFoundation\File\UploadedFile; class InputPackage { private $data; public function __construct($nx179) { $this->data = $nx179; } public static function buildFromInputJson($cANPj) { goto qzp2z; SnN51: return new InputPackage($nx179); goto RoX9x; GHRvG: $nx179 = @json_decode($nx179, true); goto SnN51; qzp2z: $nx179 = Input::get($cANPj, null); goto GHRvG; RoX9x: } public static function mergeToInput($cANPj, $VuXfH, $lIcLr = null) { if (null === $lIcLr) { Input::merge(array($cANPj => $VuXfH)); } else { goto vjXfl; k02VB: Input::merge(array($lIcLr => $HLpQn)); goto CDQm5; HzNoJ: $HLpQn[$cANPj] = $VuXfH; goto k02VB; nkcv0: if (!is_array($HLpQn)) { $HLpQn = array(); } goto HzNoJ; vjXfl: $HLpQn = Input::get($lIcLr, array()); goto nkcv0; CDQm5: } } public static function mergeToInputAll($hOl5a, $lIcLr = null) { if (null === $lIcLr) { Input::merge($hOl5a); } else { goto Do9b_; ono3S: Input::merge(array($lIcLr => $HLpQn)); goto BlXQV; e6YyH: if (!is_array($HLpQn)) { $HLpQn = array(); } goto OCK7E; OCK7E: $HLpQn = array_merge($HLpQn, $hOl5a); goto ono3S; Do9b_: $HLpQn = Input::get($lIcLr, array()); goto e6YyH; BlXQV: } } public static function build($nx179) { return new InputPackage($nx179); } public static function buildFromInput() { return new InputPackage(Input::all()); } public static function buildFromGzipJsonBody() { goto wixTg; jkzeg: if ('gzip' == $TDCpq) { $N19iJ = gzdecode(Request::instance()->getContent()); } else { $N19iJ = file_get_contents('php://input'); } goto ALKiL; ALKiL: return self::build(@json_decode($N19iJ, true)); goto hwOP1; wixTg: $TDCpq = Request::headerGet('content-encoding'); goto jkzeg; hwOP1: } public static function buildFromJsonBody() { $N19iJ = file_get_contents('php://input'); return self::build(@json_decode($N19iJ, true)); } public function set($HQ4FM, $VuXfH) { $this->data[$HQ4FM] = $VuXfH; } public function all() { return $this->data; } public function isEmpty() { return empty($this->data); } public function get($cANPj, $bX2xJ = null) { if (isset($this->data[$cANPj])) { return $this->data[$cANPj]; } return $bX2xJ; } public function getInteger($cANPj, $bX2xJ = 0) { if (isset($this->data[$cANPj])) { if (!is_string($this->data[$cANPj]) && !is_numeric($this->data[$cANPj])) { return $bX2xJ; } return intval($this->data[$cANPj]); } return $bX2xJ; } public function getFloat($cANPj, $bX2xJ = 0) { if (isset($this->data[$cANPj])) { if (!is_string($this->data[$cANPj]) && !is_numeric($this->data[$cANPj])) { return $bX2xJ; } return floatval($this->data[$cANPj]); } return $bX2xJ; } public function getPage($cANPj = 'page', $ubqta = 1, $FROwv = null) { goto VpEv_; nmf6b: return min($mZ5xK, $FROwv); goto zRnOY; gNF6V: $mZ5xK = max($mZ5xK, $ubqta); goto PfvCo; VpEv_: $mZ5xK = $this->getInteger($cANPj, 1); goto gNF6V; PfvCo: if (null === $FROwv) { return $mZ5xK; } goto nmf6b; zRnOY: } public function getPageSize($cANPj = 'pageSize', $ubqta = 2, $FROwv = 100, $RsCDD = 10) { goto QmSlo; imVDB: $qp8x7 = $this->getInteger($cANPj, $RsCDD); goto zSr9x; Ahnp0: if (null === $FROwv) { $FROwv = 100; } goto imVDB; I9zVA: if (null === $ubqta) { $ubqta = 2; } goto Ahnp0; QmSlo: if (null === $cANPj) { $cANPj = 'pageSize'; } goto I9zVA; zSr9x: return min(max($qp8x7, $ubqta), $FROwv); goto MBnlj; MBnlj: } public function getRichContent($cANPj, $bX2xJ = null) { if (isset($this->data[$cANPj])) { goto ntqEk; OK9dj: $N19iJ = HtmlUtil::filter($N19iJ); goto X7ZB_; ntqEk: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto gQ7uP; uNZZz: return $N19iJ; goto UnG2m; X7ZB_: $N19iJ = StrUtil::filterSpecialChars($N19iJ); goto uNZZz; gQ7uP: $N19iJ = trim($this->data[$cANPj]); goto OK9dj; UnG2m: } return $bX2xJ; } public function getBoolean($cANPj, $bX2xJ = false) { if (isset($this->data[$cANPj])) { if ($this->data[$cANPj]) { if ('false' === $this->data[$cANPj]) { return false; } return true; } return false; } return $bX2xJ; } public function getTrimString($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { goto MzHPl; kAVqV: if ($VuXfH !== '' && $VuXfH !== null) { return $VuXfH; } goto BZzXg; MzHPl: $VuXfH = @trim((string) $this->data[$cANPj]); goto UWB1b; UWB1b: $VuXfH = StrUtil::filterSpecialChars($VuXfH); goto kAVqV; BZzXg: } return $bX2xJ; } public function getSeperatedTagsString($cANPj, $bvUkP = ',') { return TagUtil::seperated2String($this->getTrimString($cANPj), $bvUkP); } public function getSeperatedTagsArray($cANPj, $bvUkP = ',') { return TagUtil::seperated2Array($this->getTrimString($cANPj), $bvUkP); } public function getMultiTrimString($NP7Bb, $bX2xJ = '') { goto Iwcjy; av1o7: foreach ($NP7Bb as $cANPj) { $tcwC2[$cANPj] = $this->getTrimString($cANPj, $bX2xJ); } goto qvpvG; qvpvG: return $tcwC2; goto gFhTp; Iwcjy: $tcwC2 = array(); goto av1o7; gFhTp: } public function getStringSeperatedIntegerArray($cANPj, $bX2xJ = array(), $jvg35 = ',') { $tcwC2 = $this->getStringSeparatedArray($cANPj, $bX2xJ, $jvg35); return array_values(array_filter($tcwC2, function ($yFWLi) { $yFWLi = intval($yFWLi); if (empty($yFWLi)) { return null; } return $yFWLi; })); } public function getStringSeparatedArray($cANPj, $bX2xJ = array(), $jvg35 = ',') { goto le2Z1; TU2SD: switch ($jvg35) { case ',': $VuXfH = str_replace('，', ',', $VuXfH); break; } goto ztpKc; UkmTv: if (empty($tcwC2)) { return $bX2xJ; } goto EgmSt; C7tCd: foreach (explode($jvg35, $VuXfH) as $qsK6T) { if (empty($qsK6T)) { continue; } $tcwC2[] = trim($qsK6T); } goto UkmTv; ztpKc: $tcwC2 = array(); goto C7tCd; EgmSt: return $tcwC2; goto UofI_; le2Z1: $VuXfH = $this->getTrimString($cANPj); goto TU2SD; UofI_: } public function getIdNo($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { goto zoJCh; pNIob: $VuXfH = StrUtil::filterSpecialChars($VuXfH); goto EYhWF; cORXT: $VuXfH = trim($this->data[$cANPj]); goto pNIob; EYhWF: return $VuXfH; goto D1Jkl; zoJCh: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto cORXT; D1Jkl: } return $bX2xJ; } public function getEnumValue($UUB5K, $cANPj, $bX2xJ = null) { if (isset($this->data[$cANPj])) { goto T1HQy; T1HQy: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto LaKL0; LaKL0: $VuXfH = trim($this->data[$cANPj]); goto Mz7qC; Mz7qC: if (in_array($VuXfH, $UUB5K)) { return $VuXfH; } goto djRTp; djRTp: } return $bX2xJ; } public function getPhone($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { goto yfzhD; yfzhD: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto H5y7m; HMYRZ: return $QfTuE; goto Ggff7; ye5s1: if (!FormatUtil::isPhone($QfTuE)) { return null; } goto HMYRZ; H5y7m: $QfTuE = trim($this->data[$cANPj]); goto ye5s1; Ggff7: } return $bX2xJ; } public function getTelephone($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { goto kHGO9; EnQmm: $QfTuE = FormatUtil::telephone($QfTuE); goto c4x3x; c4x3x: if ($QfTuE) { return $QfTuE; } goto jE0Uz; U4C5U: $QfTuE = trim($this->data[$cANPj]); goto EnQmm; jE0Uz: return null; goto fCO6m; kHGO9: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto U4C5U; fCO6m: } return $bX2xJ; } public function getEmail($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { goto lBtwE; uXaEW: $jnEBo = trim($this->data[$cANPj]); goto XGSh_; lBtwE: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto uXaEW; AjMo2: return $jnEBo; goto hKYlf; XGSh_: if (!FormatUtil::isEmail($jnEBo)) { return null; } goto AjMo2; hKYlf: } return $bX2xJ; } public function getDecimal($cANPj, $bX2xJ = '0.00') { if (isset($this->data[$cANPj])) { goto PHDSr; LFE2h: return $VuXfH; goto gz0vR; nzfrb: $VuXfH = bcdiv($VuXfH, 100, 2); goto LFE2h; PHDSr: if (!is_string($this->data[$cANPj]) && !is_numeric($this->data[$cANPj])) { return $bX2xJ; } goto ObZ6X; BhyYB: $VuXfH = intval(bcmul(trim($this->data[$cANPj]), 100, 2)); goto nzfrb; ObZ6X: if ($this->data[$cANPj] < 0) { return $bX2xJ; } goto BhyYB; gz0vR: } return $bX2xJ; } public function getBase64Image($cANPj, $bX2xJ = null) { if (isset($this->data[$cANPj])) { goto sXSew; sXSew: if (empty($this->data[$cANPj])) { return null; } goto YWbG2; zK86O: foreach ($pD0GE as $OFAbu) { if (0 === strpos($VuXfH, $OFAbu)) { $VuXfH = substr($VuXfH, strlen($OFAbu)); break; } } goto gqMvg; iApxE: $pD0GE = array('data:image/png;base64,', 'data:image/jpeg;base64,'); goto zK86O; gqMvg: $VuXfH = @base64_decode($VuXfH); goto LRbw0; LRbw0: if (empty($VuXfH)) { return $bX2xJ; } goto pLfWE; YWbG2: $VuXfH = $this->data[$cANPj]; goto iApxE; pLfWE: return $VuXfH; goto UACiT; UACiT: } return $bX2xJ; } public function getBase64File($cANPj, $bX2xJ = null) { if (isset($this->data[$cANPj])) { goto WddVo; SVlU9: $VuXfH = $this->data[$cANPj]; goto EV_0N; WddVo: if (empty($this->data[$cANPj])) { return null; } goto SVlU9; aJd0u: return $VuXfH; goto ejpN1; gy2b1: if (empty($VuXfH)) { return $bX2xJ; } goto aJd0u; EV_0N: $VuXfH = @base64_decode($VuXfH); goto gy2b1; ejpN1: } return $bX2xJ; } public function getDouble($cANPj, $bX2xJ = 0) { if (isset($this->data[$cANPj])) { return doubleval($this->data[$cANPj]); } return $bX2xJ; } public function getImagePath($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { if (!is_string($this->data[$cANPj])) { return $bX2xJ; } return trim($this->data[$cANPj]); } return $bX2xJ; } public function getDataTempPath($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { goto PMCNe; PMCNe: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto k4UWO; qGR4b: if (preg_match('/^data_temp\\/([a-z_]+)\\/([a-zA-Z0-9]{32}\\.[a-z0-9]+)$/', $VuXfH, $jRzIK)) { return $VuXfH; } goto LevAQ; k4UWO: $VuXfH = trim($this->data[$cANPj]); goto qGR4b; LevAQ: } return $bX2xJ; } public function getDataUploadedPath($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { goto wUCGo; wUCGo: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto gp2u1; GACi8: if (preg_match('/(data\\/[a-z]+\\/\\d{4}\\/\\d{2}\\/\\d{2}\\/[a-z0-9\\_]+\\.[a-z0-9]+)[\\?]?/', $VuXfH, $jRzIK)) { return $VuXfH; } goto ikNFf; gp2u1: $VuXfH = trim($this->data[$cANPj]); goto GACi8; ikNFf: } return $bX2xJ; } public function getDataUploadedPathArray($cANPj, $bX2xJ = array()) { if (isset($this->data[$cANPj])) { goto bjA6q; qaK7v: $WRawc = array(); goto lEKCL; lEKCL: foreach ($this->data[$cANPj] as $VuXfH) { $VuXfH = trim($VuXfH); if (preg_match('/(data\\/[a-z]+\\/\\d{4}\\/\\d{2}\\/\\d{2}\\/[a-z0-9\\_]+\\.[a-z0-9]+)[\\?]?/', $VuXfH, $jRzIK)) { $WRawc[] = $VuXfH; } } goto AX63M; AX63M: return $WRawc; goto pLviU; bjA6q: if (!is_array($this->data[$cANPj])) { return $bX2xJ; } goto qaK7v; pLviU: } return $bX2xJ; } public function getDataImagePath($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { goto Xqz6N; jyPY7: $VuXfH = trim($this->data[$cANPj]); goto O5AnX; IS9N7: return $VuXfH; goto E83ak; O5AnX: if (preg_match('/(data\\/[a-z]+\\/\\d{4}\\/\\d{2}\\/\\d{2}\\/[a-z0-9\\_]+\\.[a-z0-9]+)[\\?]?/', $VuXfH, $jRzIK)) { return $VuXfH; } goto IS9N7; Xqz6N: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto jyPY7; E83ak: } return $bX2xJ; } public function getFilePath($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { return trim($this->data[$cANPj]); } return $bX2xJ; } public function getFileData($cANPj, $bX2xJ = null) { if (isset($this->data[$cANPj])) { if ($this->data[$cANPj] instanceof UploadedFile) { $Z3orD = $this->data[$cANPj]; return array('name' => $Z3orD->getClientOriginalName(), 'data' => file_get_contents($Z3orD->getRealPath()), 'size' => $Z3orD->getSize()); } } return $bX2xJ; } public function getColorHex($cANPj, $bX2xJ = '') { if (isset($this->data[$cANPj])) { if (preg_match('/^#[0-9a-fA-F]{6}$/', $this->data[$cANPj]) || preg_match('/^#[0-9a-fA-F]{6}$/', $this->data[$cANPj])) { return $this->data[$cANPj]; } } return $bX2xJ; } public function getImagesPath($cANPj, $bX2xJ = array()) { return $this->getFilesPath($cANPj, $bX2xJ); } public function getFilesPath($cANPj, $bX2xJ = array()) { goto hn7Xz; ozPwA: return $tcwC2; goto BTSTs; j4z9n: if (!is_array($this->data[$cANPj])) { return $bX2xJ; } goto RjEf1; WMAQb: $tcwC2 = array(); goto lVoJY; hn7Xz: if (!isset($this->data[$cANPj])) { return $bX2xJ; } goto j4z9n; RjEf1: $a3n3M = $this->data[$cANPj]; goto WMAQb; lVoJY: foreach ($a3n3M as $Z3orD) { if (preg_match('/(data\\/[a-z]+\\/\\d{4}\\/\\d{2}\\/\\d{2}\\/[a-z0-9\\_]+\\.[a-z0-9]+)[\\?]?/', $Z3orD, $jRzIK)) { $tcwC2[] = $Z3orD; } else { $tcwC2[] = $Z3orD; } } goto ozPwA; BTSTs: } public function getJsonImagesPath($cANPj, $bX2xJ = array()) { return $this->getJsonFilesPath($cANPj, $bX2xJ); } public function getJsonFilesPath($cANPj, $bX2xJ = array()) { goto GqJUp; GqJUp: if (!isset($this->data[$cANPj])) { return $bX2xJ; } goto Hx_Q5; uTRki: return $tcwC2; goto HAz3G; rU4LQ: foreach ($a3n3M as $IiWca) { if (preg_match('/(data\\/[a-z]+\\/\\d{4}\\/\\d{2}\\/\\d{2}\\/[a-z0-9\\_]+\\.[a-z0-9]+)[\\?]?/', $IiWca, $jRzIK)) { $tcwC2[] = $IiWca; } else { $tcwC2[] = $IiWca; } } goto uTRki; Hx_Q5: $a3n3M = @json_decode($this->data[$cANPj], true); goto pPR7T; pPR7T: if (!is_array($a3n3M)) { return $bX2xJ; } goto D27C2; D27C2: $tcwC2 = array(); goto rU4LQ; HAz3G: } public function getJson($cANPj, $bX2xJ = array()) { goto gui6B; gui6B: if (!isset($this->data[$cANPj])) { return $bX2xJ; } goto NI6G1; NI6G1: $nx179 = @json_decode($this->data[$cANPj], true); goto NsvCW; NsvCW: if (empty($nx179)) { return $bX2xJ; } goto wUfkJ; wUfkJ: return $nx179; goto KClCI; KClCI: } public function getType($cANPj, $iNs0D, $bX2xJ = null) { goto aMrRf; A3UR1: $nx179 = $this->data[$cANPj]; goto pzyVp; gVr9p: return $bX2xJ; goto izx_2; gQItJ: $T5p2v = $iNs0D::getList(); goto yYY3Y; yYY3Y: foreach ($T5p2v as $dKmL2 => $yFWLi) { if ($nx179 == $dKmL2) { return $dKmL2; } } goto gVr9p; aMrRf: if (!isset($this->data[$cANPj])) { return $bX2xJ; } goto A3UR1; pzyVp: if (empty($nx179)) { return $bX2xJ; } goto gQItJ; izx_2: } public function getTrimStringArray($cANPj, $bX2xJ = array()) { goto hP_J2; S46zh: return $tcwC2; goto kYGGh; hP_J2: if (!isset($this->data[$cANPj])) { return $bX2xJ; } goto rkMcU; mWpRp: foreach ($this->data[$cANPj] as $DUr2V) { $tcwC2[] = trim($DUr2V); } goto S46zh; lNuwq: $tcwC2 = array(); goto mWpRp; rkMcU: if (!is_array($this->data[$cANPj])) { return $bX2xJ; } goto lNuwq; kYGGh: } public function getArray($cANPj, $bX2xJ = array()) { goto WEGb7; WEGb7: if (!isset($this->data[$cANPj])) { return $bX2xJ; } goto nss4W; AzqLt: return $this->data[$cANPj]; goto OziLF; nss4W: if (!is_array($this->data[$cANPj])) { return $bX2xJ; } goto AzqLt; OziLF: } public function getIntegerArray($cANPj, $bX2xJ = array()) { goto BHeEa; wwXFv: return $Ny6HS; goto k_2LJ; eYKQe: if (!is_array($this->data[$cANPj])) { return $bX2xJ; } goto vhGjF; BHeEa: if (!isset($this->data[$cANPj])) { return $bX2xJ; } goto eYKQe; YHcIs: foreach ($this->data[$cANPj] as $yFWLi) { $Ny6HS[] = intval($yFWLi); } goto wwXFv; vhGjF: $Ny6HS = array(); goto YHcIs; k_2LJ: } public function getNameValueArray($cANPj, $bX2xJ = array()) { goto LLNfJ; ezHIL: return $tcwC2; goto jWUZa; SOzWu: if (!is_array($this->data[$cANPj])) { return $bX2xJ; } goto o1WgU; eYjsr: foreach ($this->data[$cANPj] as $DUr2V) { $tcwC2[] = array('name' => $DUr2V['name'], 'value' => $DUr2V['value']); } goto ezHIL; o1WgU: $tcwC2 = array(); goto eYjsr; LLNfJ: if (!isset($this->data[$cANPj])) { return $bX2xJ; } goto SOzWu; jWUZa: } public function getDate($cANPj, $bX2xJ = null) { if (isset($this->data[$cANPj])) { goto LApry; u8MNK: $vTIfD = $this->data[$cANPj]; goto WNzdq; WNzdq: if (TimeUtil::isDateEmpty($vTIfD)) { return $bX2xJ; } goto p6d8W; p6d8W: return date('Y-m-d', strtotime($vTIfD)); goto ahYjO; LApry: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto u8MNK; ahYjO: } return $bX2xJ; } public function getDatetime($cANPj, $bX2xJ = null) { if (isset($this->data[$cANPj])) { goto OX5B4; fWvKk: if (TimeUtil::isDatetimeEmpty($IwDsa)) { return $bX2xJ; } goto Y9gBU; EeW2R: $IwDsa = $this->data[$cANPj]; goto fWvKk; OX5B4: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto EeW2R; Y9gBU: return date('Y-m-d H:i:s', strtotime($IwDsa)); goto bXKYK; bXKYK: } return $bX2xJ; } public function getTime($cANPj, $bX2xJ = null) { if (isset($this->data[$cANPj])) { goto MPm7A; a7Amk: if (TimeUtil::isTimeEmpty($FU6n6)) { return $bX2xJ; } goto Iyc0t; GSbB8: $FU6n6 = $this->data[$cANPj]; goto a7Amk; Iyc0t: return date('H:i:s', strtotime('2019-01-01 ' . $FU6n6)); goto XzNul; MPm7A: if (!is_string($this->data[$cANPj])) { return $bX2xJ; } goto GSbB8; XzNul: } return $bX2xJ; } public function getAsInput($cANPj) { goto CJphd; CJphd: $nx179 = array(); goto D96wD; IvMgl: return self::build($nx179); goto qxxGl; D96wD: if (isset($this->data[$cANPj]) && is_array($this->data[$cANPj])) { $nx179 = $this->data[$cANPj]; } goto IvMgl; qxxGl: } public function getSearchInput($cANPj = 'search') { goto Fafnn; qDi37: if (is_array($this->data[$cANPj])) { return self::build($this->data[$cANPj]); } goto f7muI; Fafnn: if (!isset($this->data[$cANPj])) { return array(); } goto qDi37; f7muI: return self::build(@json_decode($this->data[$cANPj], true)); goto Zd9Z0; Zd9Z0: } public function getJsonAsInput($cANPj) { goto QhfbA; YiH_4: return self::build($nx179); goto Cpj0y; bO0Mk: if (isset($this->data[$cANPj]) && is_string($this->data[$cANPj])) { $nx179 = @json_decode($this->data[$cANPj], true); } goto ApHg7; QhfbA: $nx179 = array(); goto bO0Mk; ApHg7: if (empty($nx179)) { $nx179 = array(); } goto YiH_4; Cpj0y: } public function hasKey($cANPj) { return array_key_exists($cANPj, $this->data); } }