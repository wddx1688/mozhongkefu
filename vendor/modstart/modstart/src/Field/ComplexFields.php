<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace ModStart\Field; use ModStart\Core\Util\SerializeUtil; class ComplexFields extends AbstractField { protected $width = 300; protected $listable = false; protected function setup() { $this->addVariables(array('fields' => array(), 'iconServer' => modstart_admin_url('widget/icon'), 'linkServer' => modstart_admin_url('widget/link_select'))); } private function getDefaultValues() { goto b2z4c; dYMf1: $bX2xJ = array(); goto cqPB4; b2z4c: $Px5Cq = $this->getVariable('fields'); goto dYMf1; Ycnye: return $bX2xJ; goto uaSTh; cqPB4: foreach ($Px5Cq as $vhE98) { $bX2xJ[$vhE98['name']] = isset($vhE98['defaultValue']) ? $vhE98['defaultValue'] : null; } goto Ycnye; uaSTh: } public function iconServer($HCA_O) { $this->addVariables(array('iconServer' => $HCA_O)); return $this; } public function linkServer($HCA_O) { $this->addVariables(array('linkServer' => $HCA_O)); return $this; } public function fields($VuXfH) { goto wXilY; wXilY: $this->addVariables(array('fields' => $VuXfH)); goto Dl1hm; Dl1hm: $this->defaultValue($this->getDefaultValues()); goto Y_LPf; Y_LPf: return $this; goto I69q1; I69q1: } public function unserializeValue($VuXfH, AbstractField $dBa7F) { goto XO76u; zIFPc: return $VuXfH; goto DFIrS; rJjIw: $VuXfH = @json_decode($VuXfH, true); goto yoxCO; yoxCO: if (empty($VuXfH)) { $VuXfH = new \stdClass(); } goto zIFPc; XO76u: if (null === $VuXfH) { return $VuXfH; } goto rJjIw; DFIrS: } public function serializeValue($VuXfH, $Wa8N4) { return SerializeUtil::jsonEncode($VuXfH); } public function prepareInput($VuXfH, $Wa8N4) { goto e3Ib7; e3Ib7: $VuXfH = @json_decode($VuXfH, true); goto SnaQS; SnaQS: if (empty($VuXfH)) { $VuXfH = new \stdClass(); } goto x0uCk; x0uCk: return $VuXfH; goto lMJl2; lMJl2: } }