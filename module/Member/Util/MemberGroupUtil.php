<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Util; use ModStart\Core\Dao\ModelUtil; use Module\Vendor\Util\CacheUtil; class MemberGroupUtil { public static function all() { return CacheUtil::rememberForever('MemberGroupList', function () { return ModelUtil::all('member_group', array(), array('*'), array('id', 'asc')); }); } public static function mapIdTitle() { return array_build(self::all(), function ($U8G_W, $gghxW) { return array($gghxW['id'], $gghxW['title']); }); } public static function defaultGroup() { foreach (self::all() as $hJdTO) { if ($hJdTO['isDefault']) { return $hJdTO; } } return null; } public static function defaultGroupId() { $hJdTO = self::defaultGroup(); return $hJdTO ? $hJdTO['id'] : 0; } public static function map() { return CacheUtil::rememberForever('MemberGroupMap', function () { return array_build(self::all(), function ($U8G_W, $gghxW) { return array($gghxW['id'], $gghxW); }); }); } public static function get($AoMnT) { goto FPQP8; sRfV6: if (null === $VQao2) { $VQao2 = self::map(); } goto IoR9k; JVnXA: return null; goto zvhB8; inpLh: if (isset($VQao2[$AoMnT])) { return $VQao2[$AoMnT]; } goto JVnXA; IoR9k: if (empty($AoMnT)) { foreach ($VQao2 as $AVLNU) { if ($AVLNU['isDefault']) { return $AVLNU; } } return null; } goto inpLh; FPQP8: static $VQao2 = null; goto sRfV6; zvhB8: } public static function getMemberGroup($CRCLA) { if (empty($CRCLA)) { return null; } return self::get($CRCLA['groupId']); } public static function clearCache() { CacheUtil::forget('MemberGroupList'); CacheUtil::forget('MemberGroupMap'); } }