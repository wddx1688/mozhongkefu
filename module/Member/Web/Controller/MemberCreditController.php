<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Web\Controller; use Illuminate\Support\Facades\View; use ModStart\App\Web\Layout\WebPage; use ModStart\Core\Input\Request; use ModStart\Field\AbstractField; use ModStart\Field\AutoRenderedFieldValue; use ModStart\Grid\Grid; use ModStart\Grid\GridFilter; use ModStart\Module\ModuleBaseController; use ModStart\Module\ModuleManager; use ModStart\Repository\Filter\RepositoryFilter; use Module\Member\Auth\MemberUser; use Module\Member\Support\MemberLoginCheck; class MemberCreditController extends ModuleBaseController implements MemberLoginCheck { private $api; public function __construct() { goto aimvg; WljAI: View::share('_viewMemberFrame', $this->viewMemberFrame); goto VA6ge; VA6ge: $this->api = app(\Module\Member\Api\Controller\MemberCreditController::class); goto rPFeO; aimvg: list($this->viewMemberFrame, $HdyS4) = $this->viewPaths('member.frame'); goto WljAI; rPFeO: } public function index(WebPage $ZkvUG) { goto QpKsL; sO7kN: $qCqqU->disableCUD()->disableItemOperate(); goto E9XrX; GEJKO: list($tURZC, $HdyS4) = $this->viewPaths('memberCredit.index'); goto cZHMS; E9XrX: $qCqqU->useSimple(function (AbstractField $E9h4W, $AVLNU, $oPu4k) { return AutoRenderedFieldValue::makeView('module::Member.View.pc.memberCredit.item', array('item' => $AVLNU)); }); goto ULNLI; ULNLI: if (Request::isPost()) { return $qCqqU->request(); } goto GEJKO; osd7d: $qCqqU->gridFilter(function (GridFilter $RryBq) { $RryBq->range('created_at', '时间')->datetime(); }); goto sO7kN; QpKsL: $qCqqU = Grid::make('member_credit_log'); goto DRLo1; DUWhH: return $ZkvUG->view($tURZC)->body($qCqqU); goto yREK5; DRLo1: $qCqqU->repositoryFilter(function (RepositoryFilter $RryBq) { $RryBq->where(array('memberUserId' => MemberUser::id())); }); goto osd7d; cZHMS: $ZkvUG->pageTitle('我的' . ModuleManager::getModuleConfig('Member', 'creditName', '积分')); goto DUWhH; yREK5: } }