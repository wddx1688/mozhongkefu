<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Config; use Illuminate\Support\Str; class MemberMenu { private static $menu = array(); public static function register($qei2R) { self::$menu[] = $qei2R; } public static function get() { goto aOuvU; P86kL: foreach (self::$menu as $AVLNU) { if ($AVLNU instanceof \Closure) { $AVLNU = call_user_func($AVLNU); } $qei2R = array_merge($qei2R, $AVLNU); } goto Ch0xP; aOuvU: $qei2R = array(); goto P86kL; Ch0xP: $qei2R = self::mergeMenu($qei2R); goto Gm2m3; Gm2m3: return $qei2R; goto CqePf; CqePf: } private static function sort() { static $p3Gtl = 1000; return $p3Gtl++; } private static function mergeMenu($qei2R, $bCQ1H = '', $jUaC8 = 1, $RryBq = null) { goto y1gmA; gBFW9: if ($jUaC8 == 1) { uasort($DmwGe, function ($EnX8D, $ioTcP) { return $EnX8D['sort'] - $ioTcP['sort']; }); return self::mergeMenuTree($DmwGe); } goto MCCfn; d6C8C: $DmwGe = array(); goto iGvfd; y1gmA: if (empty($qei2R)) { return array(); } goto d6C8C; iGvfd: foreach ($qei2R as $AVLNU) { goto ZVFIl; BU1QJ: if (1 == $jUaC8) { $U8G_W = $bCQ1H . $AVLNU['title'] . '^' . $AVLNU['icon'] . '^' . $AVLNU['sort']; } else { $U8G_W = $bCQ1H . $AVLNU['title']; } goto Tuy2U; SNHWO: if (!isset($AVLNU['sort'])) { $AVLNU['sort'] = self::sort(); } goto BU1QJ; Mg9dZ: if (!empty($AVLNU['children'])) { $DmwGe = array_merge($DmwGe, self::mergeMenu($AVLNU['children'], $U8G_W . '^^', $jUaC8 + 1, $RryBq)); } goto j1Gpa; Tuy2U: if (isset($AVLNU['icon'])) { if (preg_match('/^[a-zA-Z0-9\\-]+$/', $AVLNU['icon'])) { $AVLNU['icon'] = "<i class='icon iconfont icon-{$AVLNU['icon']}'></i>"; } } goto A86vg; UGQNJ: unset($DmwGe[$U8G_W]['children']); goto Mg9dZ; A86vg: if (!isset($DmwGe[$U8G_W])) { $DmwGe[$U8G_W] = $AVLNU; } goto UGQNJ; Wsbp8: if ($RryBq) { if (!call_user_func($RryBq, $AVLNU)) { continue; } } goto SNHWO; ZVFIl: if (empty($AVLNU)) { continue; } goto Wsbp8; j1Gpa: } goto gBFW9; MCCfn: return $DmwGe; goto fagp5; fagp5: } private static function mergeMenuTree($H3Pp3, $bCQ1H = '') { goto owArB; owArB: $UVD7p = array(); goto Qq5pW; g0QFy: return $UVD7p; goto DLNVc; Qq5pW: foreach ($H3Pp3 as $U8G_W => $gghxW) { goto B1e2s; co2ya: $AVLNU = $gghxW; goto HSP1F; eDD4s: if (empty($AVLNU['children']) && empty($AVLNU['url'])) { continue; } goto jSpeq; bABIN: if (empty($AVLNU['children'])) { unset($AVLNU['children']); } goto eDD4s; HSP1F: $AVLNU['children'] = self::mergeMenuTree($H3Pp3, $U8G_W . '^^'); goto bABIN; ugGs3: if ($bCQ1H) { if (!Str::startsWith($U8G_W, $bCQ1H)) { continue; } if (count(explode('^^', $bCQ1H)) !== count(explode('^^', $U8G_W))) { continue; } } else { if (1 != count($hIzdA)) { continue; } } goto co2ya; B1e2s: if ($U8G_W === $bCQ1H) { continue; } goto NPNJJ; NPNJJ: $hIzdA = explode('^^', $U8G_W); goto ugGs3; jSpeq: $UVD7p[] = $AVLNU; goto QiOvz; QiOvz: } goto g0QFy; DLNVc: } }