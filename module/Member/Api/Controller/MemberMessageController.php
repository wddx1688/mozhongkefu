<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Api\Controller; use ModStart\Core\Input\InputPackage; use ModStart\Core\Input\Response; use ModStart\Core\Util\CRUDUtil; use ModStart\Module\ModuleBaseController; use Module\Member\Auth\MemberUser; use Module\Member\Support\MemberLoginCheck; use Module\Member\Util\MemberMessageUtil; class MemberMessageController extends ModuleBaseController implements MemberLoginCheck { public function paginate() { goto ytEkU; ytEkU: $ErQts = InputPackage::buildFromInput(); goto d_7TW; cPoyD: return Response::generateSuccessPaginateData($ZkvUG, $PP9UF, $NmpUA['records'], $NmpUA['total']); goto x7I2O; DGlkR: $cD48i = array('search' => array(), 'order' => array('id', 'desc')); goto ZLUR4; DDI_T: if (!empty($YBEmG['status'])) { $cD48i['search'][] = array('status' => array('equal' => intval($YBEmG['status']))); } goto qhGFT; sLsyZ: $PP9UF = 10; goto DGlkR; ZLUR4: $YBEmG = $ErQts->getJson('search'); goto DDI_T; qhGFT: $NmpUA = MemberMessageUtil::paginate(MemberUser::id(), $ZkvUG, $PP9UF, $cD48i); goto cPoyD; d_7TW: $ZkvUG = $ErQts->getInteger('page'); goto sLsyZ; x7I2O: } public function delete() { MemberMessageUtil::delete(MemberUser::id(), CRUDUtil::ids()); return Response::generateSuccessData(array('unreadMessageCount' => MemberMessageUtil::getUnreadMessageCount(MemberUser::id()))); } public function read() { MemberMessageUtil::updateRead(MemberUser::id(), CRUDUtil::ids()); return Response::generateSuccessData(array('unreadMessageCount' => MemberMessageUtil::getUnreadMessageCount(MemberUser::id()))); } public function readAll() { MemberMessageUtil::updateReadAll(MemberUser::id()); return Response::generateSuccess(); } public function deleteAll() { MemberMessageUtil::deleteAll(MemberUser::id()); return Response::generateSuccess(); } }