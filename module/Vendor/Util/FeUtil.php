<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Vendor\Util; use ModStart\Core\Type\TypeUtil; use ModStart\Core\Util\ConstantUtil; use ModStart\Core\Util\SerializeUtil; use Module\Vendor\Support\ResponseCodes; include_once __DIR__ . '/../Shell/include.php'; class FeUtil { public static function tools($RrlCs) { goto tAIvP; Wr6a0: shell_echo_block('Uniapp Tools'); goto MajIQ; tAIvP: if (!preg_match('/module[\\/\\\\](.*?)[\\/\\\\]resources\\/(.*?)\\/?$/', $RrlCs, $rGUSQ)) { shell_echo_error('目录不正确'); die(1); } goto dS9Du; h22yN: if ($Wf_aN < 2) { goto cxQrD; Cpm8X: die(1); goto s0jN1; cxQrD: shell_echo_error('参数错误'); goto CVTO9; CVTO9: shell_echo('构建 constant.js → php tools.php DumpConstant'); goto Cpm8X; s0jN1: } goto Nn5Vl; tBrFE: shell_throws_if('文件不存在 ' . $pLjOj, !file_exists($pLjOj)); goto RDZLA; RWdvE: $aF4D_ = $GLOBALS['argv']; goto h22yN; RDZLA: $rocJI = json_decode(file_get_contents($pLjOj), true); goto mjZg4; Nn5Vl: $A7cUP = rtrim($RrlCs, '/') . '/'; goto fUMjz; fUMjz: $pLjOj = $A7cUP . 'tools.config.json'; goto tBrFE; gEFJG: $Lkhb3 = $rGUSQ[2]; goto Wr6a0; MajIQ: $Wf_aN = $GLOBALS['argc']; goto RWdvE; mjZg4: switch ($aF4D_[1]) { case 'DumpConstant': goto ur20C; m4Y3g: $YjyNU = array(); goto m8SP3; W2SES: break; goto fXBvR; Llxmv: foreach ($YjyNU as $rfBQu => $jGMz8) { $n3GvS[] = "export const {$rfBQu} = " . SerializeUtil::jsonEncodePretty($jGMz8) . ';'; } goto DbhVJ; AcPep: $q5hBQ = "{$A7cUP}src/{$AQ5Mm}/constant.js"; goto ppros; m8SP3: foreach ($rocJI['constants'] as $rfBQu) { switch ($rfBQu) { case 'ResponseCodes': goto P4qaM; P4qaM: $YjyNU['ResponseCodes'] = ConstantUtil::dump(ResponseCodes::class); goto YlEc5; bmtEq: break; goto c7U8o; YlEc5: shell_echo_info("导出 {$rfBQu}"); goto bmtEq; c7U8o: default: goto KF0kR; DIRQG: shell_echo_info("导出 {$rfBQu}"); goto gjkQ5; wa196: $YjyNU[class_basename($rfBQu)] = TypeUtil::dump($rfBQu); goto DIRQG; gjkQ5: break; goto LirLI; KF0kR: shell_throws_if('类型不存在 ' . $rfBQu, !class_exists($rfBQu)); goto wa196; LirLI: } } goto nqejo; ppros: file_put_contents($q5hBQ, $n3GvS); goto W2SES; nqejo: $n3GvS = array(); goto LczGh; ur20C: shell_throws_if('请配置 constants', empty($rocJI['constants'])); goto m4Y3g; LczGh: $n3GvS[] = '// This file is created by -> php tools.php DumpConstant'; goto Llxmv; DbhVJ: $n3GvS = implode('

', $n3GvS); goto zyZgf; zyZgf: $AQ5Mm = $Lkhb3 === 'mobile' ? 'config' : 'lib'; goto AcPep; fXBvR: default: shell_echo_error('不支持的命令 ' . $aF4D_[1]); die(1); } goto CJKAr; dS9Du: $NS22k = $rGUSQ[1]; goto gEFJG; CJKAr: } }