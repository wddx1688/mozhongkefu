<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Vendor\Util; use ModStart\Core\Exception\BizException; use ModStart\Core\Input\Response; use Module\Vendor\Provider\SmsSender\SmsSenderProvider; class SmsUtil { public static function calcNumber($n3GvS) { return ceil(mb_strlen($n3GvS) / 67); } public static function parseContent($mPYOc, $aOaiS = array()) { goto wO3bV; GWVs7: foreach ($aOaiS as $U8G_W => $gghxW) { $GZ0ou[] = '{' . $U8G_W . '}'; $KqVai[] = $gghxW; } goto DlDfp; Bl2gR: $KqVai = array(); goto GWVs7; DlDfp: return str_replace($GZ0ou, $KqVai, $mPYOc); goto cV2xd; wO3bV: $GZ0ou = array(); goto Bl2gR; cV2xd: } public static function parseTemplateParam($mPYOc) { preg_match_all('/\\{(.*?)\\}/', $mPYOc, $rGUSQ); return $rGUSQ[1]; } public static function replaceTemplate($mPYOc, $ujZqt = '#') { goto IMFSm; ARxIM: return $mPYOc; goto rGCRk; IMFSm: $uZEpM = self::parseTemplateParam($mPYOc); goto VEsS_; VEsS_: foreach ($uZEpM as $gghxW) { if (is_string($ujZqt)) { $mPYOc = str_replace('{' . $gghxW . '}', $ujZqt . $gghxW . $ujZqt, $mPYOc); } else { $mPYOc = str_replace('{' . $gghxW . '}', call_user_func($ujZqt, $gghxW), $mPYOc); } } goto ARxIM; rGCRk: } public static function templates() { $njxqq = array(array('name' => 'verify', 'title' => '验证码', 'desc' => '验证码模板变量为 code')); return $njxqq; } public static function send($jU6y9, $mPYOc, $NALde = array()) { goto t_EZ6; P2OFs: BizException::throwsIfResponseError($FZUh3); goto NPMqs; NPMqs: return Response::generateSuccess(); goto jZrtv; Qj6Be: $FZUh3 = SmsSenderProvider::get($yHanX)->send($jU6y9, $mPYOc, $NALde); goto P2OFs; xB7ao: BizException::throwsIfEmpty('短信发送未设置', $yHanX); goto Qj6Be; t_EZ6: $yHanX = app()->config->get('SmsSenderProvider'); goto xB7ao; jZrtv: } }