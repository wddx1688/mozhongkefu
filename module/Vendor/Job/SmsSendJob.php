<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Vendor\Job; use ModStart\Core\Exception\BizException; use ModStart\Core\Job\BaseJob; use ModStart\Core\Util\SerializeUtil; use Module\Vendor\Log\Logger; use Module\Vendor\Provider\SmsSender\SmsSenderProvider; class SmsSendJob extends BaseJob { public $phone; public $template; public $templateData; public static function create($jU6y9, $mPYOc, $NALde) { goto oe48l; yVmZD: $Q10Sr->template = $mPYOc; goto Oro1c; xxHql: app('Illuminate\\Contracts\\Bus\\Dispatcher')->dispatch($Q10Sr); goto m1BXt; Oro1c: $Q10Sr->templateData = $NALde; goto xxHql; oe48l: $Q10Sr = new static(); goto Wf7xs; Wf7xs: $Q10Sr->phone = $jU6y9; goto yVmZD; m1BXt: } public function handle() { goto JL_bT; JL_bT: $uD6lY = $this->phone . ' - ' . $this->template . ' - ' . SerializeUtil::jsonEncode($this->templateData, JSON_UNESCAPED_UNICODE); goto i2AHK; m2Tyn: try { goto TLksO; TLksO: BizException::throwsIfEmpty('短信发送未设置', $yHanX); goto bc5Hk; Cwkrd: BizException::throwsIfResponseError($FZUh3); goto xq3M4; bc5Hk: $FZUh3 = SmsSenderProvider::get($yHanX)->send($this->phone, $this->template, $this->templateData); goto Cwkrd; xq3M4: Logger::info('Sms', 'End', $this->phone . ' - ' . SerializeUtil::jsonEncode($FZUh3, JSON_UNESCAPED_UNICODE)); goto V9_AC; V9_AC: } catch (BizException $VPhVw) { Logger::error('Sms', 'Error', $this->phone . ' - ' . $VPhVw->getMessage()); } goto WfSL4; I6OPP: $yHanX = app()->config->get('SmsSenderProvider'); goto m2Tyn; i2AHK: Logger::info('Sms', 'Start', $uD6lY); goto I6OPP; WfSL4: } }