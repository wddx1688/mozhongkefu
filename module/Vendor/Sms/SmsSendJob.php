<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Vendor\Sms; use ModStart\Core\Exception\BizException; use ModStart\Core\Job\BaseJob; use ModStart\Core\Util\SerializeUtil; use Module\Vendor\Log\Logger; use Module\Vendor\Provider\SmsSender\SmsSenderProvider; class SmsSendJob extends BaseJob { public $phone; public $template; public $templateData; public static function create($jU6y9, $mPYOc, $NALde) { goto FALoS; FALoS: $Q10Sr = new static(); goto zXecZ; CmwWE: app('Illuminate\\Contracts\\Bus\\Dispatcher')->dispatch($Q10Sr); goto dMO3i; VxBvL: $Q10Sr->templateData = $NALde; goto CmwWE; yWv_N: $Q10Sr->template = $mPYOc; goto VxBvL; zXecZ: $Q10Sr->phone = $jU6y9; goto yWv_N; dMO3i: } public function handle() { goto HLtYR; C8nBk: Logger::info('Sms', 'Start', $uD6lY); goto M3tLy; ZzVCn: try { goto TNeS6; tS1Bo: $FZUh3 = SmsSenderProvider::get($yHanX)->send($this->phone, $this->template, $this->templateData); goto vxZUe; NMW_C: Logger::info('Sms', 'End', $this->phone . ' - ' . SerializeUtil::jsonEncode($FZUh3, JSON_UNESCAPED_UNICODE)); goto oLv6B; TNeS6: BizException::throwsIfEmpty('短信发送未设置', $yHanX); goto tS1Bo; vxZUe: BizException::throwsIfResponseError($FZUh3); goto NMW_C; oLv6B: } catch (BizException $VPhVw) { Logger::error('Sms', 'Error', $this->phone . ' - ' . $VPhVw->getMessage()); } goto zp1v5; M3tLy: $yHanX = app()->config->get('SmsSenderProvider'); goto ZzVCn; HLtYR: $uD6lY = $this->phone . ' - ' . $this->template . ' - ' . SerializeUtil::jsonEncode($this->templateData, JSON_UNESCAPED_UNICODE); goto C8nBk; zp1v5: } }